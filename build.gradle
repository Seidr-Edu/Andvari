plugins {
    id 'java-library'
}

group = 'org.java_websocket'
version = '0.1.0'

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.withType(JavaCompile).configureEach {
    options.compilerArgs += ['-Xlint:all', '-Werror']
}

tasks.register('staticCheck') {
    dependsOn 'compileJava', 'compileTestJava'
}

tasks.register('unitTest', JavaExec) {
    group = 'verification'
    description = 'Runs zero-dependency unit tests.'
    classpath = sourceSets.test.runtimeClasspath
    mainClass = 'org.java_websocket.tests.TestMain'
    dependsOn 'testClasses'
}

tasks.named('check') {
    dependsOn 'staticCheck', 'unitTest'
}


tasks.named('test') {
    enabled = false
}
